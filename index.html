<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>PREVIEW - Sindicato del Crimen</title>
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@300;400;700&family=Share+Tech+Mono&display=swap" rel="stylesheet">
<link rel="stylesheet" href="css/estilos.css">
</head>
<body>

<!-- LOADER -->
<div id="loader" class="loader-screen" style="display:none;">
  <div class="loader-terminal">
    <pre id="loaderText"></pre>
    <div class="loader-bar-container"><div class="loader-bar"></div></div>
  </div>
</div>

<!-- ACCESO -->
<div id="termsModal" class="modal">
  <div class="modal-content">
    <h2>ACCESO RESTRINGIDO</h2>
    <p>Este sistema pertenece al Sindicato del Crimen.<br>Autorizaci√≥n requerida para continuar.</p>
    <button onclick="startAccess()">Autorizar acceso</button>
  </div>
</div>

<!-- CONTENIDO -->
<div class="container" style="display:none;">
  <header class="main-header">
    <div class="header-logo">‚ü® SDC-NET ‚ü©</div>
    <h1 class="header-title">Sindicato del Crimen<br>Sistema Central</h1>
    <div class="header-status">‚óè ONLINE</div>
  </header>

  <nav class="main-nav">
    <button class="nav-btn active" onclick="location.href='index.html'"><span class="icon">üè†</span><span class="label">Inicio</span></button>
    <button class="nav-btn" onclick="location.href='noticias.html'"><span class="icon">üì∞</span><span class="label">Noticias</span></button>
    <button class="nav-btn" onclick="location.href='chat.html'"><span class="icon">üí¨</span><span class="label">Chat</span></button>
    <button class="nav-btn" onclick="location.href='sistema.html'"><span class="icon">‚öôÔ∏è</span><span class="label">Sistema</span></button>
  </nav>

  <section class="count-section">
    <h2>Cuenta atr√°s</h2>
    <div id="countdown">Cargando‚Ä¶</div>
  </section>
</div>

<script>
/* ======================================================
   SIRENA NUCLEAR DE B√öNKER ‚Äî LOOP
====================================================== */
let alarmaInterval = null;

function sirenaNuclearBunker() {
  try {
    const audioContext = new (window.AudioContext || window.webkitAudioContext)();

    alarmaInterval = setInterval(() => {

      const osc = audioContext.createOscillator();
      const gain = audioContext.createGain();
      const filter = audioContext.createBiquadFilter();

      // Oscilador nuclear
      osc.type = "sawtooth";

      // Filtro estilo bunker subterr√°neo
      filter.type = "lowpass";
      filter.frequency.value = 600;
      filter.Q.value = 18;

      osc.connect(filter);
      filter.connect(gain);
      gain.connect(audioContext.destination);

      let t = audioContext.currentTime;

      gain.gain.setValueAtTime(0.8, t);

      // ASCENSO nuclear WOOOOOOP
      osc.frequency.setValueAtTime(180, t);
      osc.frequency.exponentialRampToValueAtTime(1200, t + 1.4);

      // CA√çDA met√°lica
      osc.frequency.exponentialRampToValueAtTime(160, t + 1.7);

      // Filtro se cierra (sensaci√≥n de profundidad)
      filter.frequency.exponentialRampToValueAtTime(200, t + 1.7);

      // Desvanecer
      gain.gain.exponentialRampToValueAtTime(0.0001, t + 1.8);

      osc.start(t);
      osc.stop(t + 1.85);

    }, 1900);

  } catch (e) {
    console.warn("Error en sirena bunker:", e);
  }
}

/* ======================================================
   DESBLOQUEO AUDIO + VOZ (iPhone)
====================================================== */
let vozOK = false;

function unlockAudioAndVoice() {
  // Desbloqueo de voz
  const init = new SpeechSynthesisUtterance(".");
  init.volume = 0;
  init.lang = "es-ES";
  try { speechSynthesis.speak(init); } catch(e) {}
  vozOK = true;

  // Desbloqueo WebAudio
  try {
    const ctx = new (window.AudioContext || window.webkitAudioContext)();
    const osc = ctx.createOscillator();
    osc.frequency.value = 1;
    osc.connect(ctx.destination);
    osc.start();
    osc.stop();
  } catch(e) {}
}

/* ======================================================
   VOZ OMEGA
====================================================== */
function speakOmega() {
  if (!vozOK) return;

  const msg = new SpeechSynthesisUtterance("Protocolo Omega activado.");
  msg.pitch = 0.5;
  msg.rate = 0.9;
  msg.volume = 1.0;
  msg.lang = "es-ES";
  speechSynthesis.speak(msg);
}

/* ======================================================
   ARRANQUE GENERAL
====================================================== */
function startAccess() {

  unlockAudioAndVoice();

  document.getElementById('termsModal').style.display = 'none';
  document.getElementById('loader').style.display = 'flex';
  typeLine();

  setTimeout(() => {
    document.getElementById("loader").classList.add("loader-hide");
    setTimeout(() => {
      document.getElementById("loader").style.display = "none";
      document.querySelector('.container').style.display = 'block';
    }, 900);
  }, 5000);
}

/* ======================================================
   TERMINAL LOADER
====================================================== */
const loaderLines = [
  "[ MONITORING NODE ONLINE ]",
  "Rastreando actividad del usuario...",
  "Localizando direcci√≥n IP...",
  "Analizando patrones de comportamiento...",
  "Estableciendo vigilancia permanente...",
  "Conectando con nodos ocultos...",
  "Cifrando informaci√≥n sensible...",
  "Acceso concedido ‚úî"
];

let indexLoader = 0;
let textElement = document.getElementById("loaderText");

function typeLine() {
  if (indexLoader < loaderLines.length) {
    textElement.textContent += loaderLines[indexLoader] + "\n";
    indexLoader++;
    setTimeout(typeLine, 430);
  }
}

/* ======================================================
   COUNTDOWN ‚Äî FECHA DE AYER (ACTIVACI√ìN INMEDIATA)
====================================================== */
let countdownInterval = null;

function startCountdown() {
  countdownInterval = setInterval(updateCountdown, 1000);
  updateCountdown();
}

function updateCountdown() {

  const target = new Date();
  target.setDate(target.getDate() - 1); // AYER

  const now = new Date();
  const diff = target - now;
  const box = document.getElementById('countdown');

  if (diff <= 0) {
    clearInterval(countdownInterval);

    // SIRENA NUCLEAR
    sirenaNuclearBunker();

    // VOZ
    speakOmega();

    box.innerHTML = `
      <div class="scanlines">
        <div class="glitch" data-text="‚ö† PROTOCOLO OMEGA ACTIVADO ‚ö†">
          ‚ö† PROTOCOLO OMEGA ACTIVADO ‚ö†
        </div><br><br>

        <div class="glow-anim">
          El Sindicato del Crimen confirma el inicio de la operaci√≥n<br>
          <b>"NOCHE NEGRA NAVIDE√ëA"</b>.
        </div><br>

        <div class="alert-blink">
          Canal Omega abierto ‚Äî Contrase√±a li24ruXIMAYpar175
        </div>
      </div>
    `;
    return;
  }

  box.innerText = "00:00:00";
}

startCountdown();

/* ======================================================
   SCROLL FX
====================================================== */
window.addEventListener('scroll', () => {
  const header = document.querySelector('.main-header');
  const nav = document.querySelector('.main-nav');
  if (window.scrollY > 20) {
    header.classList.add('scrolled');
    nav.classList.add('scrolled');
  } else {
    header.classList.remove('scrolled');
    nav.classList.remove('scrolled');
  }
});
</script>

</body>
</html>
